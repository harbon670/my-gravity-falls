<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Gravity Falls: –•–∏–∂–∏–Ω–∞ –ß—É–¥–µ—Å</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap');
    
    * {
      box-sizing: border-box;
      user-select: none;
    }
    
    body { 
      background: #1a3f2a;
      display: flex; 
      align-items: center; 
      justify-content: center; 
      min-height: 100vh; 
      margin: 0; 
      padding: 5px;
      color: #fff; 
      font-family: 'VT323', monospace; 
      touch-action: none; 
    }
    
    #game-container {
      max-width: 340px;
      width: 100%;
      border-radius: 20px;
      background: #6b4e3a;
      padding: 15px 10px;
      box-shadow: 0 10px 0 #3a2e1e, 0 15px 15px rgba(0,0,0,0.5);
      border: 4px solid #c99a5a;
    }
    
    #header {
      background: #e9c97a;
      border-radius: 15px 15px 8px 8px;
      padding: 8px 5px;
      margin-bottom: 10px;
      border-bottom: 6px solid #b58b3a;
      border-left: 2px solid #ffd98c;
      border-right: 2px solid #8b691f;
    }
    
    h1 {
      font-family: 'Press Start 2P', cursive;
      color: #2a4a2a;
      font-size: 14px;
      margin: 5px 0;
      text-shadow: 3px 3px 0 #ffd966;
      text-align: center;
      line-height: 1.5;
    }
    
    #stats {
      display: flex;
      justify-content: space-between;
      background: #2d4a2a;
      border-radius: 10px;
      padding: 8px 12px;
      border: 3px solid #ffd966;
      color: white;
      font-size: 16px;
      font-family: 'Press Start 2P', cursive;
    }
    
    #score, #lives {
      color: #ffd966;
      margin-left: 5px;
    }
    
    #lives {
      color: #ff8a8a;
    }
    
    .start-hint {
      background: #c99a5a;
      color: #2a4a2a;
      text-align: center;
      padding: 10px;
      border-radius: 10px;
      font-size: 12px;
      margin-bottom: 10px;
      font-family: 'Press Start 2P', cursive;
      border-bottom: 4px solid #8b691f;
    }
    
    canvas { 
      display: block;
      margin: 0 auto 10px;
      width: 100%;
      max-width: 300px;
      height: auto;
      aspect-ratio: 300/400;
      border-radius: 16px;
      border: 4px solid #8b691f;
      box-shadow: 6px 6px 0 #3a2a0a;
      cursor: pointer;
      touch-action: none;
    }
    
    #items-guide {
      background: #2d4a2a;
      border-radius: 10px;
      padding: 10px 5px;
      border: 3px solid #ffd966;
      margin-top: 5px;
    }
    
    .guide-title {
      text-align: center;
      font-size: 12px;
      color: #ffd966;
      margin-bottom: 8px;
      font-family: 'Press Start 2P', cursive;
    }
    
    .items-row {
      display: flex;
      justify-content: center;
      gap: 25px;
      flex-wrap: wrap;
    }
    
    .item-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }
    
    .item-icons {
      font-size: 30px;
      display: flex;
      gap: 8px;
    }
    
    .item-label {
      font-size: 10px;
      background: #1a3a1a;
      padding: 4px 12px;
      border-radius: 20px;
      color: #b5ff8a;
      font-family: 'Press Start 2P', cursive;
      border: 2px solid #8ac96a;
    }
    
    .bad-group .item-label {
      background: #3a1a1a;
      color: #ff8a8a;
      border: 2px solid #c96a6a;
    }
  </style>
</head>
<body>

<div id="game-container">
  <div id="header">
    <h1>üèöÔ∏è –•–ò–ñ–ò–ù–ê –ß–£–î–ï–° üèöÔ∏è</h1>
    <div id="stats">
      <span>‚ú® <span id="score">0</span></span>
      <span>‚ù§Ô∏è <span id="lives">3</span></span>
    </div>
  </div>
  
  <div class="start-hint" id="startHint">
    üëá –¢–´–ö–ù–ò, –ß–¢–û–ë–´ –í–û–ô–¢–ò –í –•–ò–ñ–ò–ù–£ üëá
  </div>
  
  <canvas width="300" height="400" id="game"></canvas>
  
  <div id="items-guide">
    <div class="guide-title">üîç –ß–¢–û –ò–°–ö–ê–¢–¨ –í –•–ò–ñ–ò–ù–ï:</div>
    <div class="items-row">
      <div class="item-group">
        <div class="item-icons">üìì üìï üìò</div>
        <span class="item-label">–î–ù–ï–í–ù–ò–ö–ò +10</span>
      </div>
      <div class="item-group">
        <div class="item-icons">üîÆ üíé ‚ú®</div>
        <span class="item-label">–ö–†–ò–°–¢–ê–õ–õ–´ +10</span>
      </div>
      <div class="item-group bad-group">
        <div class="item-icons">üß¶ ü•´ üì¶</div>
        <span class="item-label">–•–õ–ê–ú -1 ‚ù§Ô∏è</span>
      </div>
    </div>
  </div>
</div>

<script>
  const canvas = document.getElementById('game');
  const context = canvas.getContext('2d');
  const startHint = document.getElementById('startHint');
  
  let score = 0;
  let lives = 3;
  let gameOver = false;
  let objects = [];
  let spawnTimer = 0;
  let gameStarted = false;
  
  // –ù–ê–°–¢–û–Ø–©–ò–ï –ê–†–¢–ï–§–ê–ö–¢–´ –ò–ó –ì–†–ê–í–ò–¢–ò –§–û–õ–ó!
  const items = [
    // –î–ù–ï–í–ù–ò–ö–ò (—Ä–∞–∑–Ω—ã–µ –Ω–æ–º–µ—Ä–∞)
    { name: '–î–Ω–µ–≤–Ω–∏–∫ 1', type: 'anomaly', icon: 'üìì', size: 38 },
    { name: '–î–Ω–µ–≤–Ω–∏–∫ 2', type: 'anomaly', icon: 'üìï', size: 38 },
    { name: '–î–Ω–µ–≤–Ω–∏–∫ 3', type: 'anomaly', icon: 'üìò', size: 38 },
    // –ö–†–ò–°–¢–ê–õ–õ–´
    { name: '–ö—Ä–∏—Å—Ç–∞–ª–ª', type: 'anomaly', icon: 'üîÆ', size: 40 },
    { name: '–ú–∞–≥–∏—á–µ—Å–∫–∏–π –∫–∞–º–µ–Ω—å', type: 'anomaly', icon: 'üíé', size: 35 },
    { name: '–ó–≤–µ–∑–¥–Ω–∞—è –ø—ã–ª—å', type: 'anomaly', icon: '‚ú®', size: 40 },
    // –•–õ–ê–ú (–æ–±—ã—á–Ω—ã–µ –≤–µ—â–∏)
    { name: '–°—Ç–∞—Ä—ã–π –Ω–æ—Å–æ–∫', type: 'normal', icon: 'üß¶', size: 35 },
    { name: '–ö–æ–Ω—Å–µ—Ä–≤–∞', type: 'normal', icon: 'ü•´', size: 35 },
    { name: '–ö–æ—Ä–æ–±–∫–∞', type: 'normal', icon: 'üì¶', size: 38 }
  ];

  function spawn() {
    const item = items[Math.floor(Math.random() * items.length)];
    objects.push({
      ...item,
      x: Math.random() * (canvas.width - 50) + 25,
      y: canvas.height + 30,
      speed: 0.8 + Math.random() * 1.2, // –ú–ï–î–õ–ï–ù–ù–û
    });
  }

  // –†–ò–°–£–ï–ú –û–†–ò–ì–ò–ù–ê–õ–¨–ù–£–Æ –•–ò–ñ–ò–ù–£ –ß–£–î–ï–°
  function drawMysteryShack() {
    // –ù–ï–ë–û
    context.fillStyle = '#0a1f3a';
    context.fillRect(0, 0, canvas.width, 180);
    
    // –ó–í–Å–ó–î–´
    context.fillStyle = '#ffffb5';
    for (let i = 0; i < 12; i++) {
      context.beginPath();
      context.arc(20 + i * 25, 30 + (i % 4) * 15, 2, 0, Math.PI * 2);
      context.fill();
    }
    
    // –õ–£–ù–ê
    context.fillStyle = '#f0f0c0';
    context.beginPath();
    context.arc(250, 50, 18, 0, Math.PI * 2);
    context.fill();
    
    // –ó–ï–ú–õ–Ø
    context.fillStyle = '#3a7a3a';
    context.fillRect(0, 180, canvas.width, 220);
    
    // –¢–†–û–ü–ò–ù–ö–ê
    context.fillStyle = '#8b6b4a';
    context.fillRect(120, 280, 60, 120);
    
    // –û–°–ù–û–í–ê –•–ò–ñ–ò–ù–´ (—Å—Ç–µ–Ω—ã –∏–∑ –±—Ä–µ–≤–µ–Ω)
    context.fillStyle = '#8b5a2a';
    context.fillRect(60, 140, 180, 140);
    
    // –ë–†–ï–í–ù–ê (–ø–æ–ª–æ—Å–∫–∏)
    context.strokeStyle = '#5a3a1a';
    context.lineWidth = 3;
    for (let i = 0; i < 5; i++) {
      context.beginPath();
      context.moveTo(65, 160 + i * 30);
      context.lineTo(235, 160 + i * 30);
      context.stroke();
    }
    
    // –ö–†–´–®–ê
    context.fillStyle = '#5a3a1a';
    context.beginPath();
    context.moveTo(40, 140);
    context.lineTo(150, 70);
    context.lineTo(260, 140);
    context.closePath();
    context.fill();
    
    // –ß–ï–†–ï–ü –ù–ê –ö–†–´–®–ï (—Å–∏–º–≤–æ–ª –•–∏–∂–∏–Ω—ã –ß—É–¥–µ—Å!)
    context.fillStyle = '#c0c0c0';
    context.beginPath();
    context.arc(150, 100, 12, 0, Math.PI * 2);
    context.fill();
    context.fillStyle = '#000';
    context.beginPath();
    context.arc(145, 97, 2, 0, Math.PI * 2);
    context.arc(155, 97, 2, 0, Math.PI * 2);
    context.fill();
    // –£–ª—ã–±–∫–∞
    context.beginPath();
    context.strokeStyle = '#000';
    context.lineWidth = 2;
    context.arc(150, 105, 5, 0.1, Math.PI - 0.1);
    context.stroke();
    
    // –í–´–í–ï–°–ö–ê "MYSTERY SHACK"
    context.fillStyle = '#c97a2a';
    context.fillRect(80, 185, 140, 25);
    context.fillStyle = '#ffd966';
    context.font = 'bold 10px "Press Start 2P", cursive';
    context.fillText('MYSTERY', 110, 205);
    
    // –î–í–ï–†–¨
    context.fillStyle = '#5a3a1a';
    context.fillRect(135, 200, 30, 70);
    context.fillStyle = '#c99a5a';
    context.beginPath();
    context.arc(158, 235, 4, 0, Math.PI * 2);
    context.fill();
    
    // –û–ö–ù–û –° –ì–õ–ê–ó–û–ú (–∫–∞–∫ –≤ –∑–∞—Å—Ç–∞–≤–∫–µ)
    context.fillStyle = '#add8e6';
    context.fillRect(90, 170, 25, 25);
    context.fillStyle = '#000';
    context.beginPath();
    context.arc(102, 182, 4, 0, Math.PI * 2);
    context.fill();
    
    // –û–ö–ù–û –°–ü–†–ê–í–ê
    context.fillStyle = '#add8e6';
    context.fillRect(185, 170, 25, 25);
    context.fillStyle = '#000';
    context.fillRect(195, 175, 5, 15);
    
    // –ö–£–°–¢–´
    context.fillStyle = '#2a6a2a';
    context.beginPath();
    context.arc(40, 260, 25, 0, Math.PI * 2);
    context.fill();
    context.beginPath();
    context.arc(260, 260, 25, 0, Math.PI * 2);
    context.fill();
    
    // –ó–ê–ë–û–†
    context.fillStyle = '#6b4a2a';
    for (let i = 0; i < 7; i++) {
      context.fillRect(20 + i * 40, 255, 10, 30);
    }
    context.fillRect(15, 270, 270, 6);
  }

  canvas.addEventListener('pointerdown', (e) => {
    e.preventDefault();
    startHint.style.display = 'none';
    
    if (!gameStarted) {
      gameStarted = true;
      objects = [];
      score = 0;
      lives = 3;
      gameOver = false;
      document.getElementById('score').innerText = score;
      document.getElementById('lives').innerText = lives;
      return;
    }
    
    if (gameOver) {
      gameStarted = true;
      gameOver = false;
      score = 0;
      lives = 3;
      objects = [];
      document.getElementById('score').innerText = score;
      document.getElementById('lives').innerText = lives;
      return;
    }
    
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;
    
    const mx = (e.clientX - rect.left) * scaleX;
    const my = (e.clientY - rect.top) * scaleY;

    for (let i = objects.length - 1; i >= 0; i--) {
      let obj = objects[i];
      let dist = Math.hypot(mx - obj.x, my - obj.y);
      if (dist < 30) {
        if (obj.type === 'anomaly') {
          score += 10;
          document.getElementById('score').innerText = score;
        } else {
          lives--;
          document.getElementById('lives').innerText = lives;
          if (lives <= 0) gameOver = true;
        }
        objects.splice(i, 1);
        return;
      }
    }
  });

  function loop() {
    requestAnimationFrame(loop);
    context.clearRect(0, 0, canvas.width, canvas.height);
    
    // –†–ò–°–£–ï–ú –•–ò–ñ–ò–ù–£
    drawMysteryShack();

    if (!gameStarted) {
      context.fillStyle = 'rgba(0,0,0,0.6)';
      context.fillRect(0, 0, canvas.width, canvas.height);
      context.font = '16px "Press Start 2P", cursive';
      context.fillStyle = '#ffd966';
      context.fillText('–î–û–ë–†–û', 100, 180);
      context.fillText('–ü–û–ñ–ê–õ–û–í–ê–¢–¨!', 70, 220);
      return;
    }

    if (gameOver) {
      context.fillStyle = 'rgba(0,0,0,0.7)';
      context.fillRect(0, 0, canvas.width, canvas.height);
      context.font = '16px "Press Start 2P", cursive';
      context.fillStyle = '#ff8a8a';
      context.fillText('–•–ò–ñ–ò–ù–ê', 100, 160);
      context.fillText('–ó–ê–ö–†–´–¢–ê!', 90, 200);
      context.font = '12px "Press Start 2P", cursive';
      context.fillStyle = '#ffd966';
      context.fillText('–û–ß–ö–ò: ' + score, 100, 280);
      context.fillText('–¢–´–ö–ù–ò –ï–©–Å', 90, 330);
      return;
    }

    spawnTimer++;
    if (spawnTimer > 100) {
      spawn();
      spawnTimer = 0;
    }

    // –†–ò–°–£–ï–ú –ü–†–ï–î–ú–ï–¢–´
    for (let i = objects.length - 1; i >= 0; i--) {
      let obj = objects[i];
      obj.y -= obj.speed;

      context.save();
      context.translate(obj.x, obj.y);
      context.font = obj.size + 'px "Segoe UI Emoji", Arial, sans-serif';
      context.textAlign = 'center';
      context.textBaseline = 'middle';
      
      // –¢–ï–ù–¨
      context.shadowColor = '#000';
      context.shadowBlur = 5;
      context.shadowOffsetX = 2;
      context.shadowOffsetY = 2;
      context.fillText(obj.icon, 0, 0);
      context.restore();

      if (obj.y < -30) {
        if (obj.type === 'anomaly') {
          lives--;
          document.getElementById('lives').innerText = lives;
          if (lives <= 0) gameOver = true;
        }
        objects.splice(i, 1);
      }
    }
  }

  loop();
</script>
</body>
</html>
